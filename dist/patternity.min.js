(function(f){var k,h=this,e;if(f&&"string"===typeof f)for(f=f.split(".");k=f.shift();)h[k]||(h[k]={}),h=h[k];e=h;var O=this,f=function(a,b){var c=["[object ",a,"]"].join("");return b?function(b){return typeof b===a}:function(a){return B.call(a)===c}},B=Object.prototype.toString;k="function undefined string boolean number Array Object Math Date RegExp JSON Arguments".split(" ");for(var h=k.length,g={},l;h--;)l=k[h],g["is"+l.charAt(0).toUpperCase()+l.substr(1,l.length)]=f(l,90<l.charCodeAt(0));g.isArray=
Array.isArray||g.isArray;g.isNull=function(a){return null===a};g.isDefined=function(a){return!(g.isNull(a)||g.isUndefined(a))};var r=function(a){a=B.call(a);return a.substring(8,a.length-1)},f=function(a,b){for(var c=a.split("."),d=c.shift(),i=O;d;)i[d]||(i[d]={}),0===c.length&&b&&(i[d]=b),i=i[d],d=c.shift();return i};k=function(a){function b(){}b.prototype=a;return new b};var s=function(a,b){var c,d;if(a&&b){if(C(b)){c=0;for(d=b.length;c<d;c++)s(a,b[c])}else for(c in b)b.hasOwnProperty(c)&&(a[c]=
b[c]);return a}},D=function(a,b){var c,d;if(C(b)){c=0;for(d=b.length;c<d;c++)if(!D(a,b[c]))return!1;return!0}if(P(b)){for(d in b)if(b.hasOwnProperty(d)&&(c=a[d],Q(c)||r(c)!==r(b[d])))return!1;return!0}},h=function(a){var b,c;if(!g.isArray(this))throw new TypeError("Need an Array as scope");if(!g.isFunction(a))throw new TypeError("Need function");b=0;for(c=this.length;b<c;b++)a(this[b],b,this)},C=g.isArray,P=g.isObject,Q=g.isUndefined;e.utils=s(g,{createNS:f,extend:function(a,b){var c=function(){};
c.prototype=b.prototype;a.prototype=new c;return a},createObject:Object.create||k,forEach:Array.prototype.forEach||h,mixin:s,pairCall:function(a,b,c){var d;if(g.isFunction(a)&&g.isObject(b)){for(d in b)b.hasOwnProperty(d)&&a.call(c,d,b[d]);return!0}return!1},isImplementing:D,getType:r});e.NS=f;var R=this,n=function(a,b){var c,d;if(S(b))j.forEach.call(b,function(b){n(a,b)});else for(c in b)b.hasOwnProperty(c)&&(d=b[c],T[c]||(a[c]=d))},E=function(a,b,c){c=c||b.className;t(a)?j.createNS([a,".",c].join(""),
b):u(a)?a[c]=b:R[c]=b},F=function(a,b,c){if(!t(a))throw new TypeError("a class name is required");if(!u(b))throw new TypeError(a+": class definition must be an object");if(c&&!t(c)&&typeof c!==U)throw new TypeError(a+": package must be an object or string");},G=function(a,b,c){b=m(b)?b.prototype:b;if(!j.isImplementing(a.prototype,b))throw Error(c+" implementation for interface is missing");},q=function(a,b){for(var c in a)a.hasOwnProperty(c)&&(a[c]&&"object"===typeof a[c])&&b.push({key:c,value:a[c]})},
I=function(a){for(var b=a.length,c;b--;)c=a[b],this[c.key]=H(c.value)},f=function(a,b,c){var d,i=[],e,f,g,h;F(a,b,c);e=b.Extends;f=b.Mixin;g=b.Static;h=b.Implements;m(e)&&q(e.prototype,i);q(b,i);m(f)?q(f.prototype,i):u(f)&&q(f.prototype,i);d=i.length?m(b.initialize)?function(){i.length&&I.call(this,i);b.initialize.apply(this,arguments)}:function(){i.length&&I.call(this,i)}:b.initialize||function(){};d.className=a;m(e)&&(d.prototype=H(e.prototype));n(d.prototype,b);f&&(m(f)?n(d.prototype,f.prototype):
n(d.prototype,f));h&&G(d,h);g&&j.mixin(d,g);E(c,d);return d},T={Extends:1,Implements:1,Mixin:1,Static:1,initialize:1,className:1},U="object",j=e.utils,H=j.createObject,u=j.isObject,t=j.isString,S=j.isArray,m=j.isFunction;f.prototype={isImplementing:G,validateInput:F,mixinProto:n,applyToPackage:E};e.Class=f;var J=function(a){var b=new a;this.getInstance=function(){return b}},f=function(a,b,c){K.prototype.validateInput(a,b,c);b=new J(e.Class(a,b,{}));K.prototype.applyToPackage(c,b,a);return b},K=e.Class;
f.prototype={Singleton:J};e.Singleton=f;var M=function(a,b){var c=this;Object.keys(b).forEach(function(b){if(V(a[b]))c[b]=function(){return a[b].apply(a,arguments)};else if("undefined"!==typeof a[b])W(c,b,{set:function(c){a[b]=c},get:function(){return a[b]},enumerable:!0,writeable:!0});else throw L="cannot bind "+b+"() implementation is missing",L;})},f=function(a,b,c){function d(a){if(a&&X(a))M.call(this,a,b);else throw"an object for interface binding should be defined";}d.className=a;v.prototype.validateInput(a,
b,c);d.bind=function(a){return new d(a)};d.isImplementedBy=function(a){return w.isImplementing(a,d)};v.prototype.mixinProto(d.prototype,b);v.prototype.applyToPackage(c,d);return d},v=e.Class,L,W=Object.defineProperty||function(){},w=e.utils,X=w.isObject,V=w.isFunction;f.prototype={bind:M};e.Interface=f;var Y=Array.prototype.slice,x=e.utils,y=x.isFunction;e.Class("Observable",{__observers:{},triggerObservers:function(a){var b=this.__observers[a],c=0,d;if(b){c=0;for(d=b.length;c<d;c++)b[c].apply(this,
arguments)}},get:function(a){return this[a]},set:function(a,b){var c;!x.pairCall(this.set,a,this)&&!y(this[a])&&(c=this[a],this[a]=b,this.triggerObservers(a,b,c))},callFunction:function(a){var b=Y.call(arguments,1),c;if(y(this[a]))return c=this[a].apply(this,b),this.triggerObservers(a,c,b),c},observe:function(a,b){var c=this.__observers;x.pairCall(this.observe,a,this)||(c[a]||(c[a]=[]),y(b)&&c[a].push(b))},removeObserver:function(a,b){var c=this.__observers[a]||[],d;for(d=c.length;d--;)if(c[d]===
b){c.splice(d,1);break}},removeObservers:function(a){var b=this.__observers;b[a]&&delete b[a]}},e);e.Interface("IIterator",{first:function(){},next:function(){},currentItem:function(){},isDone:function(){},each:function(){}},e);var z=e.utils;e.Class("Iterator",{Implements:e.IIterator,initialize:function(a){if(a instanceof Array)this.__iterable=a;else if(a&&z.isObject(a)){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(a[b]);this.__iterable=c}else if(a&&z.isString(a))this.__iterable=a.split("");
else throw"non iterable";this.__index=this.__currentItem=null;this.first()},first:function(){this.__index=0;return this.currentItem()},next:function(){if(!this.isDone())return this.__index++,this.currentItem()},currentItem:function(){return this.__iterable[this.__index]},isDone:function(){return this.__index===this.__iterable.length},each:function(a){var b=this.__iterable,c=[],d,e=b.length;if(z.isFunction(a))for(d=0;d<e;d++)this.__index=d,c.push(a(b[d],d,b));return c}},e);e.Class("List",{__elements:[],
add:function(a){this.__elements.push(a)},getAt:function(a){return this.__elements[a]},indexOf:function(a){for(var b=this.__elements,c=b.length;c--;)if(b[c]===a)return c;return-1},getLength:function(){return this.__elements.length},hasElement:function(a){return-1!==this.indexOf(a)},removeAt:function(a){-1<a&&this.__elements.splice(a,1)},remove:function(a){for(var b=this.indexOf(a);-1!==b;)this.removeAt(b),b=this.indexOf(a)},getElements:function(){return this.__elements},iterator:function(){return e.IIterator.bind(new e.Iterator(this.__elements))},
unique:function(){for(var a=this.__elements,b=a.length,c={},d=[],e;b--;)e=a[b],c[e]||(d.push(e),c[e]=1);this.__elements=d}},e);e.Class("ListOf",{Extends:e.List,initialize:function(a){if("function"===typeof a)this.__of=a;else throw"argument should be a constructor";},add:function(a){if(a instanceof this.__of||a.constructor&&a.constructor===this.__of)e.List.prototype.add.call(this,a);else throw"not allowed type";},execute:function(a){var b=Array.prototype.slice.call(arguments,1),c=[];this.iterator().each(function(d){c.push(d[a].apply(d,
b))});return c},setAll:function(a,b){this.iterator().each(function(c){c[a]=b})}},e);var A=e.utils,p=A.isFunction,Z=A.isObject;e.Class("Listenable",{__registry:{},addListener:function(a,b){var c=this.__registry;if(!A.pairCall(this.addListener,a,this))if(b&&(p(b)||Z(b)))c[a]||(c[a]=[]),c[a].push(b);else throw"listener has to be a function or an object";},on:function(){this.addListener.apply(this,arguments)},once:function(a,b){function c(){p(b)?b.apply(d,arguments):p(b[a])&&b[a].apply(d,arguments);d.removeListener(a,
c)}var d=this;d.addListener(a,c);return c},cancel:function(){this.removeListener.apply(this,arguments)},cancelAll:function(){this.removeListeners.apply(this,arguments)},removeListener:function(a,b){var c=this.__registry[a],d;if(c)for(d=c.length;d--;)if(c[d]===b){c.splice(d,1);break}},removeListeners:function(a){var b=this.__registry;b[a]&&delete b[a]},dispatchEvent:function(a){var b=Array.prototype.slice.call(arguments,1),c=this.__registry[a],d,e,f;if(c){e=0;for(f=c.length;e<f;e++)d=c[e],p(d)?d.apply(this,
b):p(d[a])&&d[a].apply(d,b)}}},e);var $=function(a){var b=(new Date).getTime(),c,d,e;d=0;for(e=a.length;d<e;d++)c=a[d],c.action.call(c.ctx||this,b)};e.Class("Scheduler",{initialize:function(a){if("number"===typeof a&&0<a)this.__interval=a,this.__tasks=[],this.__isRunning=!1,this.__handle=null;else throw"interval required";},addTask:function(a,b){if("function"===typeof a)this.__tasks.push({action:a,ctx:b});else throw"taks must be a function";},interval:function(a){this.__interval=a},removeTask:function(a){for(var b=
this.__tasks,c=b.length;c--;)if(b[c].action===a){b.splice(c,1);break}},reset:function(){this.stop();this.__tasks=[]},run:function(a){var b=this;a&&b.addTask(a);b.__isRunning=!0;b.__handle=setInterval(function(){b.__isRunning&&$(b.__tasks)},b.__interval)},stop:function(){this.__isRunning=!1;clearInterval(this.__handle)},isRunning:function(){return this.__isRunning}},e);var aa=function(){return""+this.__length++},N=function(a){a.handler.apply(a.ctx||this,a.args);a.clearAspect()};e.Class("Sync",{initialize:function(a){a=
a||{};this.__registry={};this.__length=0;this.__synchronize=a.synchronize||!1;"function"===typeof a.onAllReady&&(this.onAllReady=a.onAllReady)},isAllReady:function(){var a=this.__registry,b;for(b in a)if(a.hasOwnProperty(b)&&!a[b].isReady)return!1;return!0},clear:function(){this.__registry={};this.__length=0},addHandler:function(a,b,c){var d=this,e=a[b],f,g,c=c||a;"function"===typeof e&&(f=aa.call(d),a[b]=function(){var h,k=d.__synchronize,j=d.__registry;if(g=j[f]){if(g.isReady=!0,g.args=arguments,
k||(N(g),delete j[f]),d.isAllReady()){if(k)for(h in j)j.hasOwnProperty(h)&&(N(j[h]),delete j[h]);if(d.onAllReady)d.onAllReady()}}else e.apply(c||this,arguments),a[b]=e},d.__registry[f]={handler:e,clearAspect:function(){a[b]=e},ctx:c||a,isReady:!1})},onAllReady:function(){}},e)})("py");
